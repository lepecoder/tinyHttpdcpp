# TinyHttpdcpp

[Tiny HTTPd](https://sourceforge.net/projects/tinyhttpd/) implemented by C++

虽然说是用C++实现，但很多方法也没有C++风格的库函数，所以，可能就面向对象的思想吧





## 版本

用不同的分支存储不同的版本，

#### v_0.1

最初版本，简单的B/S通信模型，

服务端支持连接多个客户端，但是由于没有设置多线程，只能依次响应请求，每次和客户端通信一次就会关闭。

#### v_0.2

在第一版的基础上增加了持续连接，客户端可以持续发送多条信息。

#### v_0.3

实现多线程并发，可以同时和多个客户端通信。

- 主线程：
  - 负责监听，处理客户端的连接请求，也就是在父进程中循环调用 accept() 函数
  - 创建子线程：建立一个新的连接，就创建一个新的子进程，让这个子进程和对应的客户端通信
  - 回收子线程资源：由于回收需要调用阻塞函数，这样就会影响 accept()，直接做线程分离即可。
- 子线程：负责通信，基于主线程建立新连接之后得到的文件描述符，和对应的客户端完成数据的接收和发送。
  - 发送数据：send() / write()
  - 接收数据：recv() / read()

不同线程的栈空间(临时变量)是独占的，但是共享全局的数据区、堆区、以及内核区的文件描述符，因此需要注意 *文件覆盖*， 在多线程访问共享资源时需要进行 *线程同步*。

<img src=".assert/服务器并发 _ 爱编程的大丙.png" alt="服务器并发 _ 爱编程的大丙" style="zoom:33%;" />